# Telegram Forwarder

Этот скрипт пересылает сообщения из **закрытых** Telegram-каналов и групп (если у аккаунта есть доступ)



## Как пользоваться (кратко)

1. Получить `api_id` и `api_hash`
2. Создать и заполнить файл `.env`
3. Указать **SOURCE** и **TARGET** (ссылками на сообщения)
4. Выбрать режим пересылки
5. Запустить скрипт

---

## Как получить api_id и api_hash для Telethon

1. Перейти на официальный сайт Telegram:
   [https://my.telegram.org/auth](https://my.telegram.org/auth)
2. Ввести номер телефона и подтвердить кодом из Telegram.
3. Открыть раздел **API Development Tools**.
4. Нажать **Create new application**.
5. Заполнить поля (можно любыми данными).

После создания будут показаны:

* **api_id** — числовой идентификатор
* **api_hash** — строка из символов

✔ Эти данные нужны для работы Telethon.

⚠ **Сохранить и никому не передавать** — они дают доступ к аккаунту!

---

## Установка

Требуется:

* Python 3.10+
* установленный `uv`

Установка зависимостей:

```bash
uv pip install -r requirements.txt
```

---


## Переменные окружения (.env)

В проекте есть файл-шаблон:

```
.env.example
```

Перед первым запуском нужно **обязательно** скопировать его в `.env`:

```bash
cp .env.example .env
```

Затем открыть файл `.env` и заполнить своими данными:

```env
API_ID=123456
API_HASH=abcdef1234567890abcdef1234567890
```
---


## Первый запуск

При первом запуске Telethon:

* попросит номер телефона
* пришлёт код в Telegram
* создаст файл сессии (`*.session`)

⚠ Это нормально. Делается один раз.

---

## Настройки

Все настройки находятся в файле:

```
config/settings.py
```

---

## SOURCE и TARGET (ОБЯЗАТЕЛЬНО)

❗ **Указать ссылки на любое сообщение из каждого чата**

### Поддерживаемые форматы

```
https://t.me/c/<chat_id>/<message_id>
https://t.me/c/<chat_id>/<topic_id>/<message_id>
https://t.me/<username>/<message_id>
https://t.me/<username>/<topic_id>/<message_id>
```
❌ **Нельзя**:

* ссылки на канал без `message_id`
* числовые ID

Если формат неверный — скрипт сразу завершится с ошибкой.

---

## Режимы пересылки

Настраивается параметром:

```python
FORWARD_MODE = "post_id"
```

### post_id

Пересылает **одно конкретное сообщение**, указанное в `SOURCE`.

* если сообщение — часть альбома → пересылается **весь альбом**
* если сообщение удалено → в консоль выведется лог

---

### all

Пересылает **все сообщения** из чата-источника.

```python
FORWARD_MODE = "all"
```

---

### last_n

Пересылает последние **N** сообщений.

```python
FORWARD_MODE = "last_n"
LAST_N_MESSAGES = 10
```

---

### date_range

Пересылает сообщения за указанный период.

⚠️ **Важно:**  
Время указывается **в UTC**.

```python
FORWARD_MODE = "date_range"
DATE_FROM = "2025-01-01 00:00"
DATE_TO   = "2025-01-31 23:59"
```

Формат даты:

```
YYYY-MM-DD HH:MM
```

Если сообщение — часть альбома, альбом пересылается целиком.

---

## Работа с файлами

```python
DELETE_FILES_AFTER_SEND = True
```

* `True` — скачанные файлы удаляются после отправки
* `False` — файлы остаются в папке `downloads/`


---

## Запуск

```bash
uv run main.py
```

---

##  Будущие версии

См. `./FEATURES.MD`
